********
文件系统
********

π 集群采用 Lustre 作为后端存储系统，Lustre是一种分布式的、可扩展的、高性能的并行文件系统，能够支持数万客户端、PB级存储容量、数百GB的聚合I/O吞吐，非常适合众多客户端并发进行大文件读写的场合。
Lustre最常用于高性能计算HPC，世界超级计算机TOP 10中的70%、TOP 30中的50%、TOP 100中的40%均部署了Lustre。

π 集群中已上线多套 Lustre 文件系统，挂载在计算节点的不同目录：/lustre、/scratch。

主文件系统
==========

/lustre 目录挂载的为 π 集群中的主文件系统，共 13.1P，用户的个人目录即位于该目录。

系统特性
--------

主文件系统主要使用 HDD 盘搭建，旨在提供大容量、高可用、较高性能的存储供用户使用。搭建过程中，使用 RAID 保障硬盘级别的数据安全，使用 HA（High Availability） 保障服务器级别的高可用。

用户的主要工作、重要数据都应该发生和存储在主文件系统。

如何使用
--------

用户通过个人账户登录计算节点（包括登录节点）之后，默认进入主文件系统，即 HOME 目录。可以在以下路径找到 /lustre 提供给用户的空间： 

``/lustre/home/acct-xxxx/yyyy``

其中acct-xxxx代表计费账号（课题组账号），yyyy代表个人账号。

通过 ``cd`` ``cd $HOME`` ``cd ~`` 等方式都可进入主目录。


全闪存文件系统
==============

/scratch 目录挂载的为 π 集群中的全闪存并行文件系统，共 108T 容量，可用作用户的临时工作目录。

系统特性
--------

全闪存文件系统使用全套的 SSD（NVMe协议） 硬盘搭建，旨在提供高性能的存储供用户使用，可更好地支持 IO 密集型作业。对系统来说，单客户端最大读带宽达 5.7GB/s，最大写带宽达 10GB/s；4k 小文件读 IOPS 达 170k，写 IOPS 达 126k。但同时，由于成本问题，系统提供的容量较小；在搭建时也未设置高可用和数据备份，存在数据存储安全性不高等问题。

基于该套系统的特性，推荐用户将其作为临时工作目录，可用于

1. 存储计算过程中产生的临时文件

2. 保存读写频率高的文件副本


**注意：为了保持全闪存文件系统的稳定可用，/scratch 目录每 3 个月会进行一次清理。因此，请务必及时将重要数据保存回 /lustre 目录。**

如何使用
--------

用户可以在以下路径找到 /scratch 提供的暂存空间： 
``/scratch/home/acct-xxxx/yyyy``

其中acct-xxxx代表计费账号（课题组账号），yyyy代表个人账号。

为了快捷访问，我们已经为用户设置好环境变量，``cd $SCRATCH`` 即可进入该临时工作目录。

作业使用示例
------------
